<script lang="ts">
	import type { Army } from '~/lib/shared/types';
	import { copyLink, openInGame } from '~/lib/client/army';
	import C from '~/components';

	type Props = {
		army: Army;
	};
	const { army } = $props<Props>();
</script>

<li class="army-card">
	<div class="header">
		<h3>{army.name}</h3>
		<div class="actions">
			<a class="action" href="/armies/{army.id}">
				<svg width="24" height="17" viewBox="0 0 24 17" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M23.1351 8.23727C22.2263 5.88636 20.6485 3.85329 18.5967 2.38934C16.545 0.925384 14.1093 0.0947154 11.5906 0C9.07189 0.0947154 6.63615 0.925384 4.58442 2.38934C2.53268 3.85329 0.954886 5.88636 0.0460349 8.23727C-0.015345 8.40705 -0.015345 8.59295 0.0460349 8.76273C0.954886 11.1136 2.53268 13.1467 4.58442 14.6107C6.63615 16.0746 9.07189 16.9053 11.5906 17C14.1093 16.9053 16.545 16.0746 18.5967 14.6107C20.6485 13.1467 22.2263 11.1136 23.1351 8.76273C23.1965 8.59295 23.1965 8.40705 23.1351 8.23727ZM11.5906 15.4545C7.49513 15.4545 3.16785 12.4177 1.59922 8.5C3.16785 4.58227 7.49513 1.54545 11.5906 1.54545C15.686 1.54545 20.0133 4.58227 21.5819 8.5C20.0133 12.4177 15.686 15.4545 11.5906 15.4545Z"
						class="fill"
					/>
					<path
						d="M11.5905 3.86365C10.6735 3.86365 9.77709 4.13557 9.01464 4.64502C8.25219 5.15447 7.65794 5.87857 7.30703 6.72575C6.95611 7.57294 6.86429 8.50515 7.04319 9.40452C7.22209 10.3039 7.66366 11.13 8.31206 11.7784C8.96047 12.4268 9.78659 12.8684 10.686 13.0473C11.5853 13.2262 12.5175 13.1344 13.3647 12.7835C14.2119 12.4325 14.936 11.8383 15.4455 11.0758C15.9549 10.3134 16.2268 9.417 16.2268 8.50001C16.2268 7.27037 15.7384 6.09109 14.8689 5.22161C13.9994 4.35212 12.8201 3.86365 11.5905 3.86365ZM11.5905 11.5909C10.9791 11.5909 10.3815 11.4096 9.87325 11.07C9.36495 10.7304 8.96878 10.2476 8.73484 9.68285C8.5009 9.11806 8.43969 8.49658 8.55895 7.897C8.67821 7.29743 8.97259 6.74668 9.40486 6.31441C9.83714 5.88214 10.3879 5.58776 10.9875 5.46849C11.587 5.34923 12.2085 5.41044 12.7733 5.64438C13.3381 5.87833 13.8208 6.2745 14.1605 6.78279C14.5001 7.29109 14.6814 7.88869 14.6814 8.50001C14.6814 9.31977 14.3557 10.106 13.7761 10.6856C13.1964 11.2653 12.4102 11.5909 11.5905 11.5909Z"
						class="fill"
					/>
				</svg>
				View army
			</a>
			<button class="action" onclick={() => copyLink(army.units)}>
				<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M3.4 3.4V0.849999C3.4 0.624565 3.48955 0.408365 3.64896 0.248959C3.80836 0.0895532 4.02456 0 4.25 0H14.45C14.6754 0 14.8916 0.0895532 15.051 0.248959C15.2104 0.408365 15.3 0.624565 15.3 0.849999V12.75C15.3 12.9754 15.2104 13.1916 15.051 13.351C14.8916 13.5104 14.6754 13.6 14.45 13.6H11.9V16.15C11.9 16.6192 11.5175 17 11.044 17H0.855949C0.743857 17.0007 0.632737 16.9792 0.528974 16.9368C0.42521 16.8944 0.330848 16.8319 0.25131 16.7529C0.171771 16.6739 0.108624 16.58 0.0654961 16.4765C0.0223682 16.373 0.000109968 16.2621 0 16.15L0.00255002 4.25C0.00255002 3.7808 0.38505 3.4 0.857649 3.4H3.4ZM1.7017 5.1L1.7 15.3H10.2V5.1H1.7017ZM5.1 3.4H11.9V11.9H13.6V1.7H5.1V3.4ZM3.4 7.64999H8.49999V9.34999H3.4V7.64999ZM3.4 11.05H8.49999V12.75H3.4V11.05Z"
						class="fill"
					/>
				</svg>
				Copy link
			</button>
			<button class="action" onclick={() => openInGame(army.units)}>
				<svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M3.75 1.875C3.25272 1.875 2.77581 2.07254 2.42417 2.42417C2.07254 2.77581 1.875 3.25272 1.875 3.75V11.25C1.875 11.7473 2.07254 12.2242 2.42417 12.5758C2.77581 12.9275 3.25272 13.125 3.75 13.125H11.25C11.7473 13.125 12.2242 12.9275 12.5758 12.5758C12.9275 12.2242 13.125 11.7473 13.125 11.25V9.375C13.125 9.12636 13.2238 8.8879 13.3996 8.71209C13.5754 8.53627 13.8139 8.4375 14.0625 8.4375C14.3111 8.4375 14.5496 8.53627 14.7254 8.71209C14.9012 8.8879 15 9.12636 15 9.375V11.25C15 12.2446 14.6049 13.1984 13.9016 13.9016C13.1984 14.6049 12.2446 15 11.25 15H3.75C2.75544 15 1.80161 14.6049 1.09835 13.9016C0.395088 13.1984 0 12.2446 0 11.25V3.75C0 2.75544 0.395088 1.80161 1.09835 1.09835C1.80161 0.395088 2.75544 0 3.75 0H5.625C5.87364 0 6.1121 0.0987722 6.28791 0.274588C6.46373 0.450403 6.5625 0.68886 6.5625 0.9375C6.5625 1.18614 6.46373 1.4246 6.28791 1.60041C6.1121 1.77623 5.87364 1.875 5.625 1.875H3.75ZM9.375 1.875C9.12636 1.875 8.8879 1.77623 8.71209 1.60041C8.53627 1.4246 8.4375 1.18614 8.4375 0.9375C8.4375 0.68886 8.53627 0.450403 8.71209 0.274588C8.8879 0.0987722 9.12636 0 9.375 0H14.0625C14.3111 0 14.5496 0.0987722 14.7254 0.274588C14.9012 0.450403 15 0.68886 15 0.9375V5.625C15 5.87364 14.9012 6.1121 14.7254 6.28791C14.5496 6.46373 14.3111 6.5625 14.0625 6.5625C13.8139 6.5625 13.5754 6.46373 13.3996 6.28791C13.2238 6.1121 13.125 5.87364 13.125 5.625V3.20063L10.0388 6.28875C9.95159 6.37592 9.84811 6.44506 9.73422 6.49223C9.62033 6.5394 9.49827 6.56368 9.375 6.56368C9.25173 6.56368 9.12967 6.5394 9.01578 6.49223C8.90189 6.44506 8.79841 6.37592 8.71125 6.28875C8.62408 6.20159 8.55494 6.09811 8.50777 5.98422C8.4606 5.87033 8.43632 5.74827 8.43632 5.625C8.43632 5.50173 8.4606 5.37967 8.50777 5.26578C8.55494 5.15189 8.62408 5.04841 8.71125 4.96125L11.7994 1.875H9.375Z"
						class="fill"
					/>
				</svg>
				Open in-game
			</button>
			<a class="action" href="/user/{army.username}">
				<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path
						fill-rule="evenodd"
						clip-rule="evenodd"
						d="M8.50001 0C13.1946 0 17 3.80545 17 8.5C17.003 10.4617 16.3246 12.3636 15.0807 13.8805L15.0977 13.8992L14.9855 13.9944C14.1884 14.9372 13.1951 15.6947 12.0749 16.2138C10.9547 16.733 9.73464 17.0013 8.50001 17C5.99251 17 3.74001 15.9145 2.18451 14.189L2.01451 13.9935L1.90231 13.9L1.91931 13.8796C0.675553 12.363 -0.00286231 10.4614 9.07751e-06 8.5C9.07751e-06 3.80545 3.80546 0 8.50001 0ZM8.50001 12.75C6.91901 12.75 5.49016 13.2532 4.42596 13.9451C5.60101 14.8268 7.03096 15.3023 8.50001 15.3C9.96905 15.3023 11.399 14.8268 12.5741 13.9451C11.358 13.1659 9.94428 12.7512 8.50001 12.75ZM8.50001 1.7C7.22035 1.69996 5.96666 2.06101 4.88302 2.74163C3.79939 3.42226 2.92979 4.39484 2.37419 5.54758C1.8186 6.70033 1.59954 7.98646 1.74221 9.25813C1.88488 10.5298 2.38348 11.7354 3.18071 12.7364C4.55856 11.7478 6.43876 11.05 8.50001 11.05C10.5613 11.05 12.4415 11.7478 13.8193 12.7364C14.6165 11.7354 15.1151 10.5298 15.2578 9.25813C15.4005 7.98646 15.1814 6.70033 14.6258 5.54758C14.0702 4.39484 13.2006 3.42226 12.117 2.74163C11.0334 2.06101 9.77966 1.69996 8.50001 1.7ZM8.50001 3.4C9.40174 3.4 10.2665 3.75821 10.9042 4.39584C11.5418 5.03346 11.9 5.89826 11.9 6.8C11.9 7.70173 11.5418 8.56654 10.9042 9.20416C10.2665 9.84178 9.40174 10.2 8.50001 10.2C7.59827 10.2 6.73347 9.84178 6.09584 9.20416C5.45822 8.56654 5.10001 7.70173 5.10001 6.8C5.10001 5.89826 5.45822 5.03346 6.09584 4.39584C6.73347 3.75821 7.59827 3.4 8.50001 3.4ZM8.50001 5.1C8.04914 5.1 7.61674 5.27911 7.29793 5.59792C6.97911 5.91673 6.80001 6.34913 6.80001 6.8C6.80001 7.25087 6.97911 7.68327 7.29793 8.00208C7.61674 8.32089 8.04914 8.5 8.50001 8.5C8.95087 8.5 9.38328 8.32089 9.70209 8.00208C10.0209 7.68327 10.2 7.25087 10.2 6.8C10.2 6.34913 10.0209 5.91673 9.70209 5.59792C9.38328 5.27911 8.95087 5.1 8.50001 5.1Z"
						class="fill"
					/>
				</svg>
				{army.username}
			</a>
		</div>
	</div>
	<ul class="units-container">
		{#each army.units as unit}
			<li class="unit-container">
				<C.UnitDisplay {...unit} display="block" />
			</li>
		{/each}
	</ul>
</li>

<style>
	.army-card {
		background-color: var(--grey-800);
		overflow: hidden;
		border-radius: 6px;
		height: 100%;
		width: 100%;
	}

	.army-card h3 {
		display: flex;
		align-items: center;
		color: var(--grey-100);
		font-family: 'Poppins';
		text-align: left;
		font-size: 1em;
	}

	.army-card .header {
		display: flex;
		align-items: center;
		justify-content: space-between;
		border-bottom: 1px solid var(--grey-600);
		padding: 0.75em 1.4em 0.6em 1.4em;
		margin-bottom: 1em;
		gap: 1.25em;
	}

	.army-card .actions {
		display: flex;
		align-items: center;
		gap: 0.75em;
	}

	.army-card .action {
		display: flex;
		align-items: center;
		font-size: 0.8em;
		color: var(--grey-400);
		transition: color 0.15s ease-in-out;
		gap: 0.4em;
	}

	.army-card .action path {
		transition: fill 0.15s ease-in-out;
	}

	.army-card .action .fill {
		fill: var(--grey-400);
	}

	.army-card .action:focus,
	.army-card .action:active {
		outline: var(--primary-400) dotted 1px;
	}

	.army-card .action:hover .fill {
		fill: var(--primary-400);
	}

	.army-card .action:hover {
		color: var(--primary-400);
	}

	.army-card .action svg {
		max-height: 12px;
		height: 100%;
		width: auto;
	}

	.units-container {
		display: flex;
		flex-flow: row wrap;
		padding: 0 1.4em 1em 1.4em;
		gap: 0.3em;
	}

	.unit-container {
		font-size: 0.4em;
		height: 70px;
		width: 54px;
	}
</style>
