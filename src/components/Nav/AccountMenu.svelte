<script lang="ts">
	import type { AppState } from '$types';
	import { getContext } from 'svelte';
	import Menu from '../Menu.svelte';

	type Props = {
		open: boolean;
		elRef: HTMLElement | undefined;
	};
	let { open = $bindable(), elRef }: Props = $props();

	const app = getContext<AppState>('app');
</script>

<Menu bind:open {elRef} placementOffset={12} --menu-width="175px">
	<div class="ca-menu">
		<ul class="ca-menu-list">
			{#if app.user}
				<li>
					<a class="body focus-grey link link-desktop" href="/users/{app.user.username}" aria-label="Account">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="account-desktop">
							<path
								d="M12 0C5.376 0 0 5.376 0 12C0 18.624 5.376 24 12 24C18.624 24 24 18.624 24 12C24 5.376 18.624 0 12 0ZM12 4.8C14.316 4.8 16.2 6.684 16.2 9C16.2 11.316 14.316 13.2 12 13.2C9.684 13.2 7.8 11.316 7.8 9C7.8 6.684 9.684 4.8 12 4.8ZM12 21.6C9.564 21.6 6.684 20.616 4.632 18.144C6.73419 16.4955 9.32851 15.5995 12 15.5995C14.6715 15.5995 17.2658 16.4955 19.368 18.144C17.316 20.616 14.436 21.6 12 21.6Z"
								fill="currentColor"
							/>
						</svg>
						Profile
					</a>
				</li>
				<li>
					<a class="body focus-grey link link-desktop" href="/api/logout">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
							<path
								d="M1.81818 16C1.31818 16 0.890303 15.8261 0.534545 15.4782C0.178788 15.1304 0.000606061 14.7117 0 14.2222V1.77778C0 1.28889 0.178182 0.870518 0.534545 0.522666C0.890909 0.174815 1.31879 0.000592592 1.81818 0H7.27273C7.5303 0 7.74636 0.0853334 7.92091 0.256C8.09545 0.426666 8.18242 0.637629 8.18182 0.888888C8.18121 1.14015 8.09394 1.35141 7.92 1.52267C7.74606 1.69392 7.5303 1.77896 7.27273 1.77778H1.81818V14.2222H7.27273C7.5303 14.2222 7.74636 14.3075 7.92091 14.4782C8.09545 14.6489 8.18242 14.8598 8.18182 15.1111C8.18121 15.3624 8.09394 15.5736 7.92 15.7449C7.74606 15.9161 7.5303 16.0012 7.27273 16H1.81818ZM12.8864 8.88888H6.36364C6.10606 8.88888 5.8903 8.80355 5.71636 8.63288C5.54242 8.46222 5.45515 8.25125 5.45455 7.99999C5.45394 7.74874 5.54121 7.53777 5.71636 7.36711C5.89152 7.19644 6.10727 7.11111 6.36364 7.11111H12.8864L11.1818 5.44444C11.0152 5.28148 10.9318 5.08148 10.9318 4.84444C10.9318 4.6074 11.0152 4.4 11.1818 4.22222C11.3485 4.04444 11.5606 3.9517 11.8182 3.944C12.0758 3.93629 12.2955 4.02163 12.4773 4.2L15.7273 7.37777C15.9091 7.55555 16 7.76296 16 7.99999C16 8.23703 15.9091 8.44444 15.7273 8.62222L12.4773 11.8C12.2955 11.9778 12.0797 12.0631 11.83 12.056C11.5803 12.0489 11.3642 11.9561 11.1818 11.7778C11.0152 11.6 10.9358 11.389 10.9436 11.1449C10.9515 10.9007 11.0385 10.6969 11.2045 10.5333L12.8864 8.88888Z"
								fill="currentColor"
							/>
						</svg>
						Log out
					</a>
				</li>
			{/if}
		</ul>
	</div>
</Menu>
